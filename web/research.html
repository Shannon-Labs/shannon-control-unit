<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research • Shannon Control Unit</title>
    <meta name="description"
        content="Technical Report: Shannon Control Unit (SCU). Methodology, Control Algorithm, and Experimental Results.">

    <!-- IBM Plex Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Serif:ital,wght@0,400;0,600;1,400&display=swap"
        rel="stylesheet">

    <!-- Bell Labs Design System -->
    <link rel="stylesheet" href="bell-labs-design.css">

    <!-- MathJax -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>

    <style>
        .research-header {
            padding: var(--space-3xl) 0;
            border-bottom: 1px solid var(--gray-200);
            margin-bottom: var(--space-3xl);
        }

        .abstract-box {
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: var(--border-radius-md);
            padding: var(--space-xl);
            margin: var(--space-2xl) 0;
            font-style: italic;
        }

        .research-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .research-content h2 {
            margin-top: var(--space-3xl);
        }

        .research-content h3 {
            margin-top: var(--space-xl);
            font-size: 1.25rem;
            color: var(--gray-800);
        }

        .equation-block {
            overflow-x: auto;
            padding: var(--space-md) 0;
            margin: var(--space-lg) 0;
            text-align: center;
        }
    </style>
</head>

<body>
    <a href="#main" class="skip-link">Skip to content</a>
    <div class="grid-background"></div>

    <nav class="nav">
        <div class="nav-content">
            <a href="/" class="nav-logo">Shannon Labs</a>
            <div class="nav-links">
                <a href="/">Overview</a>
                <a href="research.html" class="is-active">Research</a>
                <a href="manifesto.html">Manifesto</a>
                <a href="https://huggingface.co/hunterbown/shannon-control-unit" target="_blank">Hugging Face</a>
                <a href="https://github.com/hmbown/shannon-control-unit" target="_blank">GitHub</a>
            </div>
            <button class="nav-menu-btn" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <main id="main" class="container">
        <header class="research-header text-center">
            <h1 class="hero-title">Shannon Control Unit</h1>
            <p class="hero-subtitle">Closed-Loop Control System for Real-Time Neural Network Training Regulation</p>
            <p class="text-muted mt-2">Hunter Bown • Shannon Labs</p>

            <div class="btn-group">
                <a href="https://huggingface.co/hunterbown/shannon-control-unit/blob/main/SCU_Technical_Report_v1.pdf"
                    class="btn btn-primary">Download PDF</a>
                <a href="https://github.com/hmbown/shannon-control-unit" class="btn btn-secondary">View Code</a>
            </div>
        </header>

        <article class="research-content">
            <div class="abstract-box">
                <strong>Abstract:</strong> We present the Shannon Control Unit (SCU), a closed-loop regularization
                mechanism for language model training. SCU treats the MDL information ratio as a controlled variable and
                adjusts the regularization coefficient ($\lambda$) via a proportional–integral (PI) controller. By
                aligning $\lambda$ with the observed imbalance between parameter complexity and data fit, SCU maintains
                a target information ratio ($S^*$) throughout optimization. Experiments on Llama 3.2 1B and 3B
                fine-tuning show consistent reductions in bits-per-token relative to tuned fixed-$\lambda$ baselines,
                without manual retuning of control gains.
            </div>

            <h2>1. Introduction</h2>
            <p>
                Large language model training exhibits time-varying overfitting pressure: early phases reward rapid
                complexity growth, while later phases benefit from stronger regularization. Standard penalties (weight
                decay, dropout) are scheduled open-loop and cannot adapt to these shifts without costly hyperparameter
                sweeps. Adaptive optimizers (Adam, RMSProp) adjust step sizes from gradient statistics but do not
                regulate model complexity against an information budget. We propose a feedback controller that measures
                the balance between parameter complexity and data fit and adjusts $\lambda$ to maintain a target
                information ratio.
            </p>

            <h2>2. Methodology</h2>

            <h3>2.1 The Information Ratio</h3>
            <p>
                Let DataBPT denote the bits-per-token training loss and ParamBPT the bits-per-token parameter update
                cost (e.g., KL term for a prior). Define the information ratio:
            </p>
            <div class="equation-block">
                $$ S(t) = \frac{\text{ParamBPT}(t)}{\text{DataBPT}(t) + \text{ParamBPT}(t)} $$
            </div>

            <h3>2.2 Control Algorithm</h3>
            <p>
                The control objective is $S(t) \to S^*$. With error $e(t) = S(t) - S^*$, SCU updates the integral term:
            </p>
            <div class="equation-block">
                $$ I(t) = I(t-1) + e(t) $$
            </div>
            <p>
                And calculates the control signal $u(t)$:
            </p>
            <div class="equation-block">
                $$ u(t) = K_p \cdot e(t) + K_i \cdot I(t) $$
            </div>
            <p>
                The regularization strength is updated exponentially:
            </p>
            <div class="equation-block">
                $$ \lambda(t+1) = \lambda(t) \cdot \exp\big(-u(t)\big) $$
            </div>
            <p>
                where the negative sign reflects that increasing $\lambda$ decreases $S$ ($\partial S / \partial \lambda
                < 0$). </p>

                    <h2>3. Results</h2>
                    <p>
                        We validated SCU by fine-tuning Llama 3.2 models on a subset of WikiText-103. The results show
                        significant improvements in compression efficiency (Bits Per Token) and Perplexity compared to
                        an optimally tuned cross-entropy baseline.
                    </p>

                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Model</th>
                                    <th>Metric</th>
                                    <th>Baseline</th>
                                    <th>SCU (PI)</th>
                                    <th>Improvement</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Llama-3.2-1B</strong></td>
                                    <td>BPT</td>
                                    <td>3.920</td>
                                    <td><strong>3.676</strong></td>
                                    <td><span class="badge badge-win">-6.2%</span></td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>Perplexity</td>
                                    <td>15.14</td>
                                    <td><strong>12.78</strong></td>
                                    <td><span class="badge badge-win">-15.6%</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Llama-3.2-3B</strong></td>
                                    <td>BPT</td>
                                    <td>1.830</td>
                                    <td><strong>1.635</strong></td>
                                    <td><span class="badge badge-win">-10.6%</span></td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>Perplexity</td>
                                    <td>3.56</td>
                                    <td><strong>3.11</strong></td>
                                    <td><span class="badge badge-win">-12.6%</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <p class="text-muted text-sm mt-2">
                        *Note: Validation performed on Llama 3.2 LoRA adapters. Baseline represents the best-performing
                        fixed-$\lambda$ configuration found via grid search.*
                    </p>

                    <h2>4. Related Work</h2>
                    <p>
                        <strong>EntroPIC (2025):</strong> Recent independent work applies PI control to stabilize policy
                        entropy in reinforcement learning. This convergence indicates that control-theoretic feedback is
                        effective for stabilizing training dynamics. SCU targets the MDL information ratio during
                        supervised pretraining, whereas EntroPIC targets policy entropy in RL.
                    </p>

        </article>

        <footer class="footer">
            <div class="footer-content">
                <div class="footer-bottom">
                    &copy; 2025 Shannon Labs.
                </div>
            </div>
        </footer>
    </main>

    <script>
        const menuBtn = document.querySelector('.nav-menu-btn');
        const navLinks = document.querySelector('.nav-links');
        menuBtn.addEventListener('click', () => {
            navLinks.classList.toggle('is-open');
            menuBtn.classList.toggle('is-active');
        });
    </script>
</body>

</html>